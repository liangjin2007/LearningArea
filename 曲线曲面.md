## 曲线曲面



```
一种是最终生成的曲线通过所有的给定型值点，比如抛物样条曲线和三次参数样条曲线等，这样的曲线适用于插值放样；另一种曲线是，它的最终结果并不一定通过给定的型值点，而只是比较好地接近这些点，这类曲线（或曲面）比较适合于外形设计。

法国的Bezier提出的Bezier曲线， 通过控制点来定义曲线的形状。 

Gordon, Forrest, Riesenfeld等人提出了B样条曲线。

```

### n+1 个控制点

### 三次样条（插值）
Ref: 《离散几何处理与应用》鲍虎军 黄劲 刘利刚
```
每对点之间都是三次函数 p(u) = A_3x4 (u3, u2, u, 1)^T

4元一次方程组需要4个方程才能求解。

分析的时候可只考虑x， 比如n = 1的情况下， 2个控制点。是4个未知变量。 插值提供2n个约束，n-1个内部点提供一阶导和二阶导相等约束提供2n-2个约束，还需要2个约束才能。

自然边界条件。二次导数为0。

缺点： 任意一个控制点移动后所有的系数需要重新计算，因此缺乏局部控制能力，任意的局部变化都会影响到整条曲线。
```

### Hermite样条（插值）
Ref: 《离散几何处理与应用》鲍虎军 黄劲 刘利刚
```
对每一段曲线p(u), u in [0, 1], 除了两个端点的插值，还提供两个插值点上的切方向，
p(0) = p_k， p(1) = p_k+1, p'(0) = dp_k, p'(1) = dp_k+1

可推导出Hermite插值样条的具体形式

p(u) = p_k(2u^3-3u^2+1) + p_k+1(-2u^3+3u^2) - dp_k(u^3-2u^2+u) + dp_k+1(u^3-u^2) = p_k H_0(u) + p_k+1 H_1(u) + ...

H_k(u)称为埃尔米特插值多项式

缺点： 局部斜率并不容易事先获知。 
```


### Bezier曲线
Ref: 《离散几何处理与应用》鲍虎军 黄劲 刘利刚
```
由特征多边形来定义曲线。 理论上，贝塞尔曲线可以精确地模拟任何平滑的曲线，包括圆形。

(1) 只有第一个顶点和最后一个顶点在曲线上；
(2) 其余的顶点则用于定义曲线的导数、阶次和形状；
(3) 第一条边和最后一条边则表示了曲线在两端点处的切线方向。

p(u) = p0 B_{0,n}(u) + p1 B_{1,n}(u) + ... + pn B_{n,n}(u)， B_{k,n} = C(n, k)u^k(1-u)^(n-k)

抛物线： 3个控制点， n= 3
三次Bezier曲线, n = 3， 4个控制点。

性质：
  B_{k,n}(u) = (1-u) B_{k,n-1}(u) + u B_{k-1,n-1}(u), n > k >= 1
  B_{k,k}(u) = u^k
  B_{0, k} = (1-u)^k
  插值过两个端点。
  首尾切线沿着控制多边形的边。
  参数曲线总是落在控制点形成的多边形凸包内。

```


### Bezier曲面
Ref: 《离散几何处理与应用》鲍虎军 黄劲 刘利刚
```
p(u, v) = sum p_{j, k} B_{j,m}(v)  B_{k,n}(u) 0 <= u, v <= 1
```

### B样条曲面
Ref: 《离散几何处理与应用》鲍虎军 黄劲 刘利刚
```

p(u) = sum p_k B_{k, d}(u), u_min <= u <= u_max, 2 <= d <= n+1

在DCC软件中d一般取3

u的取值范围受到B-样条参数的影响，

插值函数 B_{k,d}(u)是一个d-1次的多项式

插值函数通过递归定义： Cox-deBoor递归公式

B_{k,1} = {1 if u_k <= u <= u_k+1; 0 else}, 0 <= k <= n

B_{k,d} = (u - u_k)/(u_k+d-1 - u_k) B_{k,d-1}(u) + (u_k+d - u)/(u_k+d - u_k+1) B_{k+1,d-1}(u)

节点向量{uj}, 长度与控制点相关，所以增加区间的同时控制点的数量也需要进行一定的适应变化。

B样条的优点： 利用控制点的增删或者修改来进行曲线的设计。

性质：
  1. 在u所处的整个区间上，d-1次的多项式曲线具有C^(d-2)的连续性。
  2. 具有n + 1个控制点的B样条由n+1个插值函数共同决定。       
  3. 每个插值函数B_{k, d}定义在以节点u_k开始的d段子区间上 [u_k, u_k+1], ..., [u_k+d-1, u_k+d]
  4. 整个区间由n+d+1个端点值分割为n+d个子区间。 ？ 
  5. 每段样条曲线受到d个控制点的影响。
  6. 每一个控制点最多影响到d段曲线区间。      
  7.曲线落在凸包内。
```

### 有理样条
```
有理样条： 基函数（插值函数）是有理多项式的样条曲线。 思维多项式曲线在三维的齐次变换投影。

有理B样条： p(u) = [sum w_k p_k B_{k, d}(u)] / [sum w_k B_{k, d}(u)]

均匀有理B样条： 权重都为1。

NURBS： 非均匀有理B样条。

有理样条能够精确表示各种圆锥曲线（圆和椭圆），非有理样条只能一定程度地逼近各种圆锥曲线
```






