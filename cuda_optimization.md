## 观点
- [写CUDA到底难在哪？](https://www.zhihu.com/question/437131193/answer/1800559419)

- [Bank Conflict](https://blog.csdn.net/wd1603926823/article/details/78326570)
```
比如有个global memory buffer 是三角形顶点坐标{{p0_i, p1_i, p2_i}, ...} 它的尺寸为3*4*3*numTriangles。如何优化内存？

```

## CUDA编程 基础与实践 樊哲勇 
- 第五章 获得GPU加速的关键
```
数据传输比例较小
核函数的算术强度较高
核函数中定义的线程数目较多。-> 增大核函数的并行规模
```

- 第六章 CUDA的内存组织
```
内存类型
  静态全局内存 写法 __device__ int c = 1; cudaMemcpyToSymbol。
  常量内存： 有常量缓存的全局内存， 大小64kb。 一个Warp（线程束）中的线程要读取相同的常量内存数据。
  寄存器： 在芯片上。是所有内存中访问速度最高的。有数量限制。一个线程可见。单个线程寄存器数上限255
  局部内存： 寄存器中放不下的变量有可能在局部内存中。 从硬件上看，局部内存只是全局内存的一部分。局部内存的延迟也很高。 每个线程最多512K。
  共享内存：在芯片上。 2070好像是48kb, 2080好像是64kb。对整个线程块可见。主要作用是减少对全局内存的访问，或者改善对全局内存的访问模式。
```
```
SM及其占有率
  一个GPU包含多个SM。
  一个SM包含如下资源：
    一定数量的寄存器： 一般是64k。
    一定数量的共享内存： 比如rtx2080是64k，跟寄存器数量一致。
    常量内存的缓存
    纹理和表面内存的缓存
    L1缓存
    两个（计算能力6.0）或4个（其他计算能力）线程束调度器warp sheduler。以用在不同线程的上下文间迅速切换。
    执行核心
      若干整数运算核心
      若干单精度xxx
      若干双精度xxx
      若干单精度浮点数超越函数
      若干混合精度的张量核心 tensor cores
SM占有率
  要让占有率不小于25%
  并不是占有率越大越好
  为啥并行规模很大，但是SM占有率还是达不到100%

其他
  一个线程块的最大线程数是1024
  一个SM中最多能拥有的线程块个数为16（开普勒架构和图灵架构）或者32（麦克斯韦架构、帕斯卡架构和伏特架构）
  一个SM中最多能拥有的线程个数为2048（从开普勒架构到伏特架构）或者1024（图灵架构）， rtx 2070/2080是图灵架构， rtx 3090是安培架构
  
```
## 工具的使用
- NSight Compute

- NSight System
```
1. 项目属性右键设置debug
2. VS2017 -> 扩展 -> NSight - > Start CUDA Debugging(Next-Gen)
VS2017 -> 扩展 -> NSight -> Windows -> Warp Info
VS2017 -> 扩展 -> NSight -> Windows -> Lane Info ? 

```
